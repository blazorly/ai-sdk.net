@{
    ViewData["Title"] = "AI Chat";
}

<div class="container-fluid h-100">
    <div class="row h-100">
        <!-- Main Chat Area -->
        <div class="col-lg-8 col-md-12 d-flex flex-column chat-container">
            <div class="chat-header">
                <h1 class="h4 mb-0">
                    <i class="bi bi-chat-left-text me-2"></i>
                    AI Chat Assistant
                </h1>
                <p class="text-muted mb-0 small">
                    Powered by AI SDK for .NET
                </p>
            </div>

            <!-- Messages Container -->
            <div id="messagesContainer" class="messages-container flex-grow-1">
                <div class="welcome-message text-center">
                    <i class="bi bi-robot welcome-icon"></i>
                    <h2>Welcome to AI Chat!</h2>
                    <p class="text-muted">
                        Start a conversation by typing a message below.
                        <br>
                        Choose between regular or streaming responses.
                    </p>
                </div>
            </div>

            <!-- Input Area -->
            <div class="input-area">
                <form id="chatForm" class="d-flex flex-column">
                    <div class="input-group mb-2">
                        <textarea
                            id="messageInput"
                            class="form-control"
                            placeholder="Type your message here..."
                            rows="1"
                            required></textarea>
                        <button class="btn btn-primary" type="submit" id="sendButton">
                            <i class="bi bi-send-fill"></i>
                            Send
                        </button>
                    </div>
                    <div class="d-flex gap-2 align-items-center">
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="streamToggle" checked>
                            <label class="form-check-label" for="streamToggle">
                                <i class="bi bi-broadcast"></i>
                                Stream Response
                            </label>
                        </div>
                        <button type="button" class="btn btn-sm btn-outline-secondary" id="clearButton">
                            <i class="bi bi-trash"></i>
                            Clear Chat
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Sidebar with Settings & Info -->
        <div class="col-lg-4 col-md-12 sidebar">
            <div class="settings-panel">
                <h5 class="mb-3">
                    <i class="bi bi-sliders me-2"></i>
                    Settings
                </h5>

                <div class="mb-3">
                    <label for="systemPrompt" class="form-label">System Prompt</label>
                    <textarea
                        id="systemPrompt"
                        class="form-control"
                        rows="3"
                        placeholder="You are a helpful assistant...">You are a helpful, friendly AI assistant.</textarea>
                    <small class="text-muted">Guides the AI's behavior and personality</small>
                </div>

                <div class="mb-3">
                    <label for="temperature" class="form-label">
                        Temperature: <span id="temperatureValue">0.7</span>
                    </label>
                    <input
                        type="range"
                        class="form-range"
                        id="temperature"
                        min="0"
                        max="2"
                        step="0.1"
                        value="0.7">
                    <small class="text-muted">Lower = focused, Higher = creative</small>
                </div>

                <div class="mb-3">
                    <label for="maxTokens" class="form-label">Max Tokens</label>
                    <input
                        type="number"
                        class="form-control"
                        id="maxTokens"
                        value="500"
                        min="50"
                        max="4000">
                    <small class="text-muted">Maximum response length</small>
                </div>

                <hr>

                <div class="info-panel">
                    <h6 class="mb-2">
                        <i class="bi bi-info-circle me-1"></i>
                        Features
                    </h6>
                    <ul class="small">
                        <li>Real-time streaming responses</li>
                        <li>Configurable AI parameters</li>
                        <li>Token usage tracking</li>
                        <li>Modern, responsive UI</li>
                        <li>No API key required (mock mode)</li>
                    </ul>
                </div>

                <hr>

                <div class="usage-panel">
                    <h6 class="mb-2">
                        <i class="bi bi-bar-chart me-1"></i>
                        Session Statistics
                    </h6>
                    <div class="small">
                        <div class="d-flex justify-content-between mb-1">
                            <span>Messages Sent:</span>
                            <strong id="messageCount">0</strong>
                        </div>
                        <div class="d-flex justify-content-between mb-1">
                            <span>Total Tokens:</span>
                            <strong id="totalTokens">0</strong>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Auto-resize textarea
        const textarea = document.getElementById('messageInput');
        textarea.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = (this.scrollHeight) + 'px';
        });

        // Update temperature display
        document.getElementById('temperature').addEventListener('input', function() {
            document.getElementById('temperatureValue').textContent = this.value;
        });
    </script>
}
